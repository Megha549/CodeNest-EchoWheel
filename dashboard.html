<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EchoWheel Dashboard</title>
  <link rel="stylesheet" href="style.css">
  <link rel="icon" type="image/png" href="wheelchair.png">
  <script src="https://cdn.jsdelivr.net/npm/qrcodejs/qrcode.min.js"></script>
  
</head>

<body>
  <script>
    // Prevent unauthenticated access
    const user = JSON.parse(localStorage.getItem("user"));
    if (!user) {
      alert("Please login first.");
      window.location.href = "login.html";
    }
  </script>

  <div class="sidebar">
    <h2>ğŸ¦½ EchoWheel</h2>
    <nav>
      <ul>
        <li><a href="dashboard.html" class="active">Dashboard</a></li>
        <li><a href="patient-form.html">Patient Info</a></li>
        <li><a href="medication.html">Medication</a></li>
        <li><a href="logs.html">Emergency Logs</a></li>
        <li><a href="qr.html">QR Health ID</a></li>
        <li><a href="settings.html">Settings</a></li>
      </ul>
    </nav>
  </div>

  <main>
    <header>
      <div class="user-panel">
        <span>ğŸ‘¤ <span id="username"></span></span> | <span>âš™ï¸ Settings</span>
        <button onclick="logout()" class="small-btn">ğŸšª Logout</button>
      </div>
    </header>

    <div class="grid-container">
      <!-- Sensor Panel -->
      <section class="panel sensor">
        <h2>ğŸ“¡ Sensor Status</h2>
        <ul>
          <li>ğŸ› Speed: <span>1.8 m/s</span></li>
          <li>â†ªï¸ Tilt: <span>Left</span></li>
          <li>ğŸš§ Obstacle: <span>No</span></li>
          <li>ğŸš¨ Emergency: <span class="alert">Yes</span></li>
        </ul>
      </section>

      <!-- Emergency + GPS -->
      <section class="panel alert-gps">
        <button class="alert-btn">ğŸ”´ Send Emergency Alert</button>
        <p class="status">âœ… Status: Alert Sent!</p>

        <div class="gps-box">
          <h3>ğŸ§­ GPS Location</h3>
          <p>ğŸ“ Connaught Place, Delhi</p>
          <button class="small-btn">ğŸ”„ Refresh</button>
          <button class="small-btn">ğŸ—ºï¸ View Map</button>
        </div>
      </section>

      <!-- Medication -->
      <section class="panel meds">
        <h2>ğŸ’Š Medication Tracker</h2>
        <ul>
          <li>â˜‘ï¸ 9:00 AM â€“ Paracetamol</li>
          <li>ğŸ”” 2:00 PM â€“ BP Medicine (Upcoming)</li>
        </ul>
        <button class="small-btn">â• Add Reminder</button>
        <button class="small-btn">ğŸ•’ History</button>
      </section>

      <!-- QR Health -->
      <section class="panel health-qr">
        <h2>ğŸ†˜ QR Health ID</h2>
        <p>This helps emergency helpers scan & access patient's health info quickly.</p>
        <button class="small-btn" onclick="generateQR()">Generate Health QR</button>
        <div id="qrcode" style="margin-top: 10px;"></div>
        <p style="margin-top: 10px;">â“ Missing patient info? <a href="patient-form.html">Fill here</a></p>
      </section>
    </div>

    <footer>
      <h3>ğŸ§¾ Recent Activity</h3>
      <ul>
        <li>[10:00 AM] ğŸš¨ Emergency alert sent</li>
        <li>[09:30 AM] ğŸ› Speed normal</li>
        <li>[09:00 AM] ğŸ’Š Reminder: Take medicine</li>
      </ul>
    </footer>
  </main>

  <script>
    // Logout logic
    function logout() {
      localStorage.removeItem("user");
      window.location.href = "login.html";
    }

    // Display user name
    const userData = JSON.parse(localStorage.getItem("user"));
    if (userData) {
      document.getElementById("username").textContent = userData.name || "User";
    }

    // Generate QR code logic
    function generateQR() {
      const healthData = {
        name: "Megha Garg",
        age: 25,
        bloodGroup: "B+",
        allergies: "None",
        emergencyContact: "9876543210"
      };

      const qrContainer = document.getElementById("qrcode");
      qrContainer.innerHTML = ""; // clear previous

      new QRCode(qrContainer, {
        text: JSON.stringify(healthData),
        width: 150,
        height: 150
      });
    }
  </script>
</body>

</html>
